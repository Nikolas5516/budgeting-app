<div class="page-layout">
  <app-sidebar></app-sidebar>

  <div class="app-container">
    <div class="overview-header">
      <h1>Savings Overview</h1>
      <p class="header-subtitle">Here's a snapshot of your savings this month</p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <p-card class="stat-card">
        <ng-template pTemplate="content">
          <div class="stat-content">
            <div class="stat-icon total-icon">
              <i class="pi pi-wallet"></i>
            </div>
            <div>
              <p class="stat-label">Total Savings</p>
              <p class="stat-value">${{ totalSavings }}</p>
            </div>
          </div>
        </ng-template>
      </p-card>

      <p-card class="stat-card">
        <ng-template pTemplate="content">
          <div class="stat-content">
            <div class="stat-icon emergency-icon">
              <i class="pi pi-shield"></i>
            </div>
            <div>
              <p class="stat-label">Emergency Fund</p>
              <p class="stat-value">${{ emergencyFund }}</p>
            </div>
          </div>
        </ng-template>
      </p-card>

      <p-card class="stat-card">
        <ng-template pTemplate="content">
          <div class="stat-content">
            <div class="stat-icon retirement-icon">
              <i class="pi pi-briefcase"></i>
            </div>
            <div>
              <p class="stat-label">Retirement</p>
              <p class="stat-value">${{ retirement }}</p>
            </div>
          </div>
        </ng-template>
      </p-card>

      <p-card class="stat-card">
        <ng-template pTemplate="content">
          <div class="stat-content">
            <div class="stat-icon other-icon">
              <i class="pi pi-gift"></i>
            </div>
            <div>
              <p class="stat-label">Other</p>
              <p class="stat-value">${{ otherSavings }}</p>
            </div>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Monthly Savings Chart -->
    <div class="monthly-overview">
      <h2 class="section-title">Monthly Savings</h2>
      <div class="chart-wrapper">
        <p-chart type="bar" [data]="chartData" [options]="chartOptions"></p-chart>
      </div>
    </div>

    <!-- Content Grid: Recent Transactions + Tips -->
    <div class="content-grid">
      <!-- Recent Transactions -->
      <div class="transactions-section">
        <h3 class="section-title">Recent Savings Transactions</h3>

        <div *ngIf="recentTransactions && recentTransactions.length > 0; else noTransactions">
          <div class="transactions-list">
            <div class="transaction-item" *ngFor="let transaction of recentTransactions">
              <div class="transaction-left">
                <div class="transaction-icon">
                  <i [class]="'pi ' + getIconClass(transaction.goal)"></i>
                </div>
                <div class="transaction-details">
                  <p class="transaction-source">
                    {{ transaction.goal || 'Unknown Goal' }}
                  </p>
                  <p class="transaction-timestamp">
                    {{ transaction.date ? (transaction.date | date: 'yyyy-MM-dd') : 'No Date' }}
                  </p>
                </div>
              </div>
              <div class="transaction-actions">
                <p-button
                  label="Edit"
                  class="action-btn edit-btn"
                  [style]="{'background-color': '#a78bfa', 'border': 'none', 'font-size': '0.75rem'}"
                  [routerLink]="['/savings/edit', transaction.id]">
                </p-button>
                <p-button
                  label="Delete"
                  class="action-btn delete-btn"
                  [style]="{'background-color': '#f472b6', 'border': 'none', 'font-size': '0.75rem'}"
                  (onClick)="deleteTransaction(transaction.id)">
                </p-button>
              </div>
            </div>
          </div>
        </div>

        <ng-template #noTransactions>
          <p class="no-data">No recent transactions found.</p>
        </ng-template>

        <p-button
          label="See All"
          class="see-all-btn"
          [routerLink]="['/savings/list']"
          [style]="{'background-color': '#7c3aed', 'border': 'none', 'width': '100%'}">
        </p-button>
      </div>

      <!-- Savings Tips -->
      <div class="tips-section">
        <h3 class="section-title">Savings Tips</h3>

        <div class="tips-list">
          <div class="tip-item">
            <div class="tip-icon">
              <i class="pi pi-calendar"></i>
            </div>
            <div class="tip-content">
              <p class="tip-title">Save a portion every month</p>
              <p class="tip-description">- Consistency is key</p>
            </div>
          </div>

          <div class="tip-item">
            <div class="tip-icon">
              <i class="pi pi-shield"></i>
            </div>
            <div class="tip-content">
              <p class="tip-title">Separate emergency funds</p>
              <p class="tip-description">- Be prepared</p>
            </div>
          </div>

          <div class="tip-item">
            <div class="tip-icon">
              <i class="pi pi-sync"></i>
            </div>
            <div class="tip-content">
              <p class="tip-title">Automate transfers</p>
              <p class="tip-description">- Avoid forgetting</p>
            </div>
          </div>

          <div class="tip-item">
            <div class="tip-icon">
              <i class="pi pi-chart-line"></i>
            </div>
            <div class="tip-content">
              <p class="tip-title">Track your progress</p>
              <p class="tip-description">- Stay motivated</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
